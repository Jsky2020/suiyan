<!DOCTYPE html>
<html lang="en">
 <head>
  <!-- Meta -->
  <meta charset="utf-8"/>
  <meta content="IE=edge" http-equiv="X-UA-Compatible"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <title>
   碎言博客碎言博客
  </title>
  <meta content="Python,Django,JavaScript,程序员,人生苦短,我用Python" name="keywords"/>
  <meta content=" Python Django JavaScript 学习讨论,我们是一群热爱Python的程序员，人生苦短，我用JavaScript！一个不会JavaScript的Python开发者不是一个好网管。" name="description"/>
  <meta content="J.sky" name="author"/>
  <link href="/assets/images/favicon.ico" rel="shortcut icon"/>
  <!-- CSS -->
  <link href="/assets/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="/assets/plugins/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet"/>
  <link href="/assets/css/theme-dark-1.css" id="blogcss" rel="stylesheet" type="text/css"/>
  <!-- highlight.js Markdown代码美化 -->
  <link href="/assets/plugins/highlight/styles/atom-one-dark.css" id="highlight" rel="stylesheet"/>
 </head>
 <body>
  <header class="header text-center">
   <h1 class="blog-name pt-lg-4 mb-0 hide">
    <a href="index.html">
     碎言博客
    </a>
   </h1>
   <nav class="navbar navbar-expand-lg navbar-dark" id="blog-nav">
    <button aria-controls="navigation" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-target="#navigation" data-toggle="collapse" type="button">
     <i aria-hidden="true" class="fa fa-bars fa-lg">
     </i>
    </button>
    <div class="collapse navbar-collapse flex-column" id="navigation">
     <div class="profile-section pt-3 pt-lg-0">
      <img class="profile-image mb-3 rounded-circle mx-auto hide" height="160px" src="/assets/images/touxiang.jpg" width="160px"/>
      <div class="blog-description mb-3 hide">
       You see see you , This one day day di.
      </div>
      <!--//sns-->
      <ul class="social-list list-inline py-3 mx-auto">
       <li>
        <a class="hide" href="https://github.com/bosichong/suiyan" target="blank_blank">
         <i class="fa fa-github fa-lg">
         </i>
        </a>
       </li>
       <li>
        <a class="hide" href="https://gitee.com/J_Sky/suiyan" target="blank_blank">
         <i class="fa fa-git fa-lg">
         </i>
        </a>
       </li>
       <li>
        <a class="hide" href="https://weibo.com/qq285911" target="blank_blank">
         <i class="fa fa-weibo fa-lg">
         </i>
        </a>
       </li>
       <li>
        <a class="hide" href="https://user.qzone.qq.com/285911/" target="blank_blank">
         <i class="fa fa-qq fa-lg">
         </i>
        </a>
       </li>
       <li>
        <a class="hide" href="https://www.zhihu.com/people/J_sky/activities" target="blank_blank">
         <i class="fa fa-book fa-lg">
         </i>
        </a>
       </li>
      </ul>
      <!--//social-list-->
      <hr/>
     </div>
     <!--//profile-section-->
     <ul class="blog-nav navbar-nav flex-column text-left">
      <li class="nav-item hide">
       <a class="nav-link" href="/index.html">
        <span>
         <i class="fa fa-home fa-lg">
         </i>
         Blog Home
        </span>
       </a>
      </li>
      <li class="nav-item hide">
       <a class="nav-link" href="/archives.html">
        <span>
         <i class="fa fa-archive fa-lg">
         </i>
         Blog Archive
        </span>
       </a>
      </li>
      <li class="nav-item hide">
       <a class="nav-link" href="/tags.html">
        <span>
         <i class="fa fa-tags fa-lg">
         </i>
         Blog Tag
        </span>
       </a>
      </li>
      <li class="nav-item hide">
       <a class="nav-link" href="/blog/aboutme.html">
        <span>
         <i class="fa fa-user fa-lg">
         </i>
         About Me
        </span>
       </a>
      </li>
     </ul>
     <form class="sform hide">
      <div class="form-row">
       <div class="form-group col-md-8">
        <input class="form-control" id="skey" placeholder="JavaScript" type="text"/>
       </div>
       <div class="form-group col-md-3">
        <button class="search btn btn-primary" data-target=".bd-example-modal-lg" data-toggle="modal" type="button">
         Search
        </button>
       </div>
      </div>
     </form>
     <a href="https://www.aliyun.com/sale-season/2020/procurement-new-members?userCode=cnafsz3c" target="_blank">
      <img alt="【采购季】上云仅¥223/3年" class="img-fluid" src="/assets/images/ad/320X100.jpg"/>
     </a>
    </div>
   </nav>
  </header>
  <div class="main-wrapper">
   <section class="blog-list px-3 py-5 p-md-5">
<div class="data-list list-group">
 <div class="blog-article">
  <h1 class="title">
   实战：利用Django开发部署自己的个人博客（5）Django admin后台管理
  </h1>
  <span class="author">
   J.sky
  </span>
  <span class="time">
   2017-11-23 18:49:06
  </span>
  <span class="tag">
   Django
  </span>
 </div>
 <p>
 </p>
 <p>
  上节我们有数据库及表，但通过
  <code>
   Django shell
  </code>
  来操作数据库并不太方便，而且我们是要做一个
  <code>
   blog
  </code>
  ,那么我们能不能快速的拥有一个后台管理系统呢？
答案是肯定的，
  <code>
   Django
  </code>
  提供了一个功能强大的配置起来还算简单的后台管理系统，那么我们先实现这个管理系统，然后再完善一下我们的数据库及表。
 </p>
 <h2>
  先创建一个管理员ID
 </h2>
 <p>
  如果不创建管理员ID，在某些地方调用User表时都会多少有些问题，所以我们先创建管理员，
终端下输入：
  <code>
   python manage.py createsuperuser
  </code>
 </p>
 <pre><code>➜  blog01 git:(master) ✗ python3 manage.py createsuperuser

You have 2 unapplied migration(s). Your project may not work properly until you apply the migrations for app(s): myblog.
Run 'python manage.py migrate' to apply them.

Username (leave blank to use 'j_sky'): bosi
Email address: bosichong@qq.com
Password: 
Password (again): 
This password is too short. It must contain at least 8 characters.
This password is entirely numeric.
Password: 
Password (again): 
Superuser created successfully.
</code></pre>
 <p>
  中间需要设置一个邮箱及密码，密码要求为8位以上，通过以上设置，管理员就创建成功了。
 </p>
 <h2>
  启用
  <code>
   admin
  </code>
  后台管理
 </h2>
 <p>
  然后我们启动服务器：
  <code>
   python3 manage.py runserver
  </code>
  访问地址：
  <code>
   127.0.0.1:8000/admin/
  </code>
  ,你会发现一个后台登陆管理系统的入口。
 </p>
 <p>
  <img alt="输入图片说明" src="/assets/images/media/upload/2017/11/Snip20171122_16.png"/>
 </p>
 <p>
  用刚才创建的管理员登陆，成功后如下图：
 </p>
 <p>
  <img alt="输入图片说明" src="/assets/images/media/upload/2017/11/Snip20171122_17.png"/>
 </p>
 <p>
  我们发现这里默认有一个用户和组的管理，没有我们的文章管理，我们来添加
编辑
  <code>
   myblog.admin.py
  </code>
 </p>
 <pre><code>from django.contrib import admin
from .models import Article

admin.site.register(Article)
</code></pre>
 <p>
  然后刷新后台管理页面，我们可以看到我们的文章管理出来了，这里你可以点进去看看，是不是发现之前添加的一些数据了，接下来我们可以丰富一下我们的数据表的字段。
 </p>
 <h2>
  博客数据库表设计
 </h2>
 <p>
  对于这个自用的博客设计，我们应该把重点放在博客的基础功能实现上，而一些功能的扩展如果确实有需要我们可以日后再添加。
所以对于一个基本的博客应该的数据表应该包括：用户，文章，分类三个表即可实现一个个人博客的需要的基础功能。
可能有的朋友说太少了，确实，但是以后你可以继续开发添加更多的功能。
 </p>
 <h2>
  设计数据库表及字段
 </h2>
 <p>
  修改上节中
  <code>
   models.py
  </code>
  的代码
修改如下：
 </p>
 <pre><code>from django.db import models
from django.contrib.auth.models import User#引入Django User

class Category(models.Model):
    #分类表
    title = models.CharField(max_length=20, verbose_name = '分类名称', default = '')

#创建文章表，通过继承models.Model来创建文章表
class Article(models.Model):
    #文章表
    title = models.CharField(max_length=50, verbose_name = 'blog标题', default = '')#创建标题
    content = models.TextField(verbose_name = '博客正文', default = '')
    category = models.ForeignKey(Category, verbose_name = '所属分类', default = '')
    user = models.ForeignKey(User, verbose_name='文章作者', null=True, blank=True)
    #文章创建时间，这里的auto_now_add=True表示自动在数据库里创建时间。
    create_time = models.DateTimeField(verbose_name='文章创建时间', auto_now_add=True,)
</code></pre>
 <p>
  这里的文章表关联分类和用户，是一对多的关联。用户表我们直接调用了
  <code>
   Django
  </code>
  自带的user表，这个稍后我们在做研究。
 </p>
 <p>
  然后我们通过终端命令更新数据库中的表：
 </p>
 <p>
  在blog01目录下输入：
 </p>
 <pre><code>➜  blog01 git:(master) ✗ python3 manage.py makemigrations
No changes detected
➜  blog01 git:(master) ✗ python3 manage.py makemigrations
No changes detected
➜  blog01 git:(master) ✗ python3 manage.py migrate       
Operations to perform:
Apply all migrations: admin, auth, contenttypes, myblog, sessions
Running migrations:
Applying myblog.0002_auto_20171122_0957... OK
Applying myblog.0003_remove_article_user... OK
Applying myblog.0004_article_user... OK
Applying myblog.0005_auto_20171122_1032... OK
➜  blog01 git:(master) ✗
</code></pre>
 <p>
  如果输入命令后报错
  <code>
   django.db.utils.IntegrityError: NOT NULL constraint failed: myblog_article.user_id
  </code>
  请删除我们在
  <code>
   django shell
  </code>
  中添加的测试数据，然后再修改数据表，这里其实不用删除也可以更新，需要为字段添加一个默认值
  <code>
   default = 1
  </code>
  ，就可以了，当然这个我没有测试，我只是猜测。
 </p>
 <p>
  我们启动服务器进入后台看下当前的管理页面：
 </p>
 <p>
  <img alt="输入图片说明" src="/assets/images/media/upload/2017/11/Snip20171123_20.png"/>
 </p>
 <p>
  我们发现并没有分类
  <code>
   Category
  </code>
  的管理连接，我们来添加上，并管理页面添加一些字段显示及搜索。
我们以分类表为例：
  <code>
   models.py
  </code>
  代码修改如下：
 </p>
 <pre><code>class Category(models.Model):
    #分类表
    title = models.CharField(max_length=20, verbose_name = '分类名称', default = '')

    class Meta:
        verbose_name = u'博客分类'
        verbose_name_plural = verbose_name

    def __str__(self):
        return self.title
</code></pre>
 <p>
  修改后，我们刷新后台管理页：
 </p>
 <p>
  <img alt="输入图片说明" src="/assets/images/media/upload/2017/11/Snip20171123_21.png"/>
 </p>
 <p>
  我们可以看到后台中
  <code>
   myblog
  </code>
  中的一些变化，这样后台看起来更直观了，我们继续以博客分类为例，编辑
  <code>
   admin.py
  </code>
  ，修改代码：
 </p>
 <pre><code>class CategoryAdmin(admin.ModelAdmin):
    #设置显示
    list_display = ('id',title',)

admin.site.register(Category,CategoryAdmin)
</code></pre>
 <p>
  进入后台，添加两个分类，然后效果如下图：
 </p>
 <p>
  <img alt="输入图片说明" src="/assets/images/media/upload/2017/11/Snip20171123_24.png"/>
 </p>
 <p>
  然后我们继续编辑
  <code>
   models.py admin.py
  </code>
  中的代码，修改文章的后台显示，具体代码请参考源文件，这里我就不贴了。
一切编辑好后我们查看一下效果：
 </p>
 <p>
  <img alt="输入图片说明" src="/assets/images/media/upload/2017/11/Snip20171123_23.png"/>
 </p>
 <p>
  <img alt="输入图片说明" src="/assets/images/media/upload/2017/11/Snip20171123_24.png"/>
 </p>
 <p>
  至此，我们的后台已经有一个简单的样子啦，随着我们的博客数据库表的不断更新修改，你也应该对应的修改
  <code>
   admin.py
  </code>
  文件中的代码，这样可以在后台更方便的添加修改文章。
虽然
  <code>
   Django
  </code>
  自带的后台系统简单，但功能上基本可以满足日常需要了，做为博客的后台来用，足够了。
 </p>
 <h2>
  本文源码下载：
 </h2>
 <ul>
  <li>
   <a href="https://github.com/bosichong/17python.com/tree/master/Django">
    github
   </a>
  </li>
  <li>
   <a href="https://gitee.com/J_Sky/17python.com/tree/master/Django">
    开源中国码云镜像gitee
   </a>
  </li>
 </ul>
 <div class="blog-article">
  <h1 class="title">
   实战：利用Django开发部署自己的个人博客（4）Models 数据模型
  </h1>
  <span class="author">
   J.sky
  </span>
  <span class="time">
   2017-11-20 18:20:43
  </span>
  <span class="tag">
   Django
  </span>
 </div>
 <p>
 </p>
 <p>
  几乎所有的程序都会和数据打交道，之前以极简方式了解了一下
  <code>
   Python
  </code>
  中操作
  <code>
   sqlite3
  </code>
  ，应该是很简单了，但如果你更深入的学习了
  <code>
   Django
  </code>
  中的
  <code>
   QuerySet API
  </code>
  ，你会发现利用
  <code>
   Django ORM
  </code>
  打理你的数据库会更方便直观。
  <code>
   Django ORM
  </code>
  是完全可以脱离WEB使用的，为了更加直观，我们这次只用Django的数据模型做些简单的测试,如果使用ORM方式进行数据库操作就不用写SQL语句了。
 </p>
 <h2>
  <code>
   Django
  </code>
  中配置数据库
 </h2>
 <p>
  你可以创建一个新项目和新应用，我们继续使用之前的
  <code>
   blog01
  </code>
  项目。
设置
  <code>
   blog01.settings.py
  </code>
 </p>
 <pre><code>DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.sqlite3',
        'NAME': os.path.join(BASE_DIR, 'db.sqlite3'),
    }
}
</code></pre>
 <p>
  这里设置数据库的物理位置及使用何种数据库，我们这里使用
  <code>
   sqlite3
  </code>
  数据库。
 </p>
 <h2>
  创建表及字段
 </h2>
 <p>
  在
  <code>
   myblog.models.py
  </code>
  中输入以下代码：
 </p>
 <pre><code>from django.db import models
#创建文章表，通过继承models.Model来创建文章表
class Article(models.Model):
    title = models.CharField(max_length=50, verbose_name = 'blog标题', default = '')#创建标题
    content = models.TextField(berbose_name = '博客正文', default = '')
</code></pre>
 <p>
  这样的话我就创建了一个博客文章表及两个字段，其中包括标题及文章内容，可能有同学会问，文章怎么可能就只有二个字段？要不要一起都建好？
不要急，Django的强大之处就是可以随时升级修改你的数据库，稍后我们还会继续填添加其它表及字段的。
 </p>
 <h2>
  运行终端创建数据库表
 </h2>
 <p>
  终端进入项目目录
  <code>
   blog01
  </code>
  ,运行:
  <code>
   python3 manage.py makemigrations
  </code>
 </p>
 <pre><code>➜  blog01 git:(master) ✗ python3 manage.py makemigrations 
Migrations for 'myblog':
myblog/migrations/0001_initial.py
    - Create model Article
➜  blog01 git:(master) ✗
</code></pre>
 <p>
  <code>
   0001_initial.py
  </code>
  是什么？我可以打开看看。
通过源代码查看，可以发现，这是一个数据库表创建代码文件，在我们执行这个文件前，数据库是没有创建的，这个可以在数据库管理软件中查看难。
那么我们现在就通过
  <code>
   Django
  </code>
  执行命令创建数据表。
 </p>
 <p>
  终端运行:
  <code>
   python3 manage.py migrate
  </code>
 </p>
 <pre><code>➜  blog01 git:(master) ✗ python3 manage.py migrate
Operations to perform:
Apply all migrations: admin, auth, contenttypes, myblog, sessions
Running migrations:
Applying contenttypes.0001_initial... OK
Applying auth.0001_initial... OK
Applying admin.0001_initial... OK
Applying admin.0002_logentry_remove_auto_add... OK
Applying contenttypes.0002_remove_content_type_name... OK
Applying auth.0002_alter_permission_name_max_length... OK
Applying auth.0003_alter_user_email_max_length... OK
Applying auth.0004_alter_user_username_opts... OK
Applying auth.0005_alter_user_last_login_null... OK
Applying auth.0006_require_contenttypes_0002... OK
Applying auth.0007_alter_validators_add_error_messages... OK
Applying auth.0008_alter_user_username_max_length... OK
Applying myblog.0001_initial... OK
Applying sessions.0001_initial... OK
</code></pre>
 <p>
  好家伙，这不对哇，我明明是创建了一个数据表，怎么出来这么多？哈，如果你是头一次创建Django的数据库表，他会把一些项目自带的数据表一起创建了，
当然这其中也包括你刚刚创建的数据库及表
  <code>
   Applying myblog.0001_initial... OK
  </code>
  我们通过
  <code>
   DBeaver
  </code>
  来查看表结构：
 </p>
 <p>
  <img alt="输入图片说明" src="/assets/images/media/upload/2017/11/Snip20171120_14.png"/>
 </p>
 <p>
  到这里我们的数据表创建完毕，接下来我们操作我们的表，进行增删改查。
 </p>
 <h2>
  <code>
   Django ORM CURD
  </code>
  操作
 </h2>
 <p>
  这里我们使用
  <code>
   Django shell
  </code>
  ，强大的终端数据库操作命令
  <code>
   python3 manage.py shell
  </code>
  。
 </p>
 <pre><code>➜  blog01 git:(master) ✗ python3 manage.py shell   
Python 3.6.1 (v3.6.1:69c0db5050, Mar 21 2017, 01:21:04) 
[GCC 4.2.1 (Apple Inc. build 5666) (dot 3)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
(InteractiveConsole)
&gt;&gt;&gt; from myblog.models import Article as ac #导入模型类
&gt;&gt;&gt; ac.objects.create(title='222',content='22222222222222222222222')#添加一条记录
&lt;Article: Article object&gt;
&gt;&gt;&gt; s = ac.objects.get(title='222')#查询一条记录
&gt;&gt;&gt; print(s)
Article object
&gt;&gt;&gt; print(s.title)
222
&gt;&gt;&gt; print(s.content)
22222222222222222222222
&gt;&gt;&gt; print(s.id)
2
</code></pre>
 <p>
  强大无须多言，我觉得有一点点面向对象编程经验的同学一眼就能看明白这些代码的含意。
我们发现，
  <code>
   Django
  </code>
  为表自动创建了一个自增主键，很方便哈。
 </p>
 <p>
  附一些常用字段参数
 </p>
 <pre><code>primary_key = False/True   # 是否设置为主键
blank = False/True         # 是否可为空，这其实是用于Field的判断
null = False/True          # 是否可为空，这才是真正的数据库里面是否可以为null
max_length = 3             # 最大长度，对整型无效
default = ''               # 设置默认值
verbose_name =             # 相当于备注，如果没给出那么就是该字段,当然，要指定的话，可以直接第一个参数一个字符串就可以指定了
editable = False/True      # 是否可编辑
unique = False/True        # 是否唯一
auto_now = False/True      # 用于时间，每次更新记录的时候更新该字段
auto_now_add = False/True  # 用于时间，创建新纪录的时候自动更新该字段
choices # 很实用的一个功能，相当于存储一个枚举列表，其中左边的key是实际存储在数据库中的值，例如，可以这样定义一个字段：
    YEAR_IN_SCHOOL_CHOICES= (
        ('FR', 'Freshman'),
        ('SO', 'Sophomore'),
        ('JR', 'Junior'),
        ('SR', 'Senior'),
    )
    然后在定义字段的时候给个参数choices=YEAR_IN_SCHOOL_CHOICES，在插入字段的时候，使用'RF'这样的，在获取字段值的时候这样：p.get_year_in_school_display()即可显示'Freshman'
verbose_name        # 定义字段的注释
</code></pre>
 <p>
  字段中的常用类型。
 </p>
 <pre><code># 数字类型：
AutoField        # 自增长字段
IntegerField    # 长度为11的整数
PositiveIntegerField：
SmallIntegerField
PositiveSmallIntegerField
BigIntegerField：
BinaryField：
BooleanField：
NullBooleanField：
DecimalField(max_digits = None, decimal_places = None)
FloatField

# 字符类型
CharField    # 字符串类型，可用max_length指定长度，枚举类型也使用该方式，只需要指定枚举枚举元组即可，例如type = models.CharField('类型', choices=CONTENT_TYPE)，其中CONTENT_TYPE=(('a', 'abc'))
TextField：text类型
CommaSeparatedIntegerField：用逗号分隔的整数，我擦，这有用

# 时间类型
DateField    # DATE类型
TimeField    # datetime.time，时间
DateTimeField()    # DATETIME类型，包括了日期和时间，需要注意的是Django默认的TIME_ZONE是UTC，在初始化的时候，格式如"2015-04-27T15:01:00Z"，它属于python里面的datetime.datetime类型，可分别用year/month/day等获取时间。另外Django如果要实用MySQL里面的TIMESTAMP类型也是用该字段表示，并且在插入的时候不能直接插入一个整数，依然只能插入一个datetime.datetime对象，用时间戳的时候USE_TZ必须为False
unique_for_date属性：比如，如果有一个title字段，其有一个参数unique_for_date = "pub_date"，那么该表就不会出现title和pub_date同时相同的情况，其它的还有unique_for_month,unique_for_year

其它很有用的类型：
EmailField：Email邮箱类型
FileField：文件类型，不过不能设置为primary_key和unique，要使用该字段还有很多需要注意的地方，具体的见官方文档
FilePathField：同上
ImageField
IPAddressField：从1.7开始已经不建议使用了，应该使用下面这个
GenericIPAddressField：
URLField
UUIDField
</code></pre>
 <p>
  通过上边简单的小例子，我们体验了强大简单的
  <code>
   Django shell
  </code>
  ,ORM使我们从繁琐SQL重复的SQL语句编写中解脱出来，
而且终端下的操作大大提高了对数据库操作验证的简单性，同时我们也可以发现
  <code>
   Django ORM
  </code>
  是完全可以脱离WEB使用的，只要做好配置文件，使用正确的目录即可。
 </p>
 <h2>
  本文源码下载：
 </h2>
 <ul>
  <li>
   <a href="https://github.com/bosichong/17python.com/tree/master/Django">
    github
   </a>
  </li>
  <li>
   <a href="https://gitee.com/J_Sky/17python.com/tree/master/Django">
    开源中国码云镜像gitee
   </a>
  </li>
 </ul>
 <div class="blog-article">
  <h1 class="title">
   听说存储数据Python与SQLite3更配哦！
  </h1>
  <span class="author">
   J.sky
  </span>
  <span class="time">
   2017-11-16 17:34:15
  </span>
  <span class="tag">
   数据库
  </span>
 </div>
 <p>
 </p>
 <p>
  曾经以为数据库自己一定需要大的，好的，功能多的，处理数据快的，迸发牛的，现在想想就象上小学时时常想：以后考大学是北大还是清华呢？后来才发现自己真特么多虑了。
如果你只是个人或是小型的应用，我这里隆重的推荐给你SQLite这个迷你型的数据库。
 </p>
 <h2>
  SQLite
 </h2>
 <p>
  SQLite 是一个软件库，实现了自给自足的、无服务器的、零配置的、事务性的 SQL 数据库引擎。SQLite 是在世界上最广泛部署的 SQL 数据库引擎。SQLite 源代码不受版权限制。
是不是很兴奋？没有其它数据库的安装配置繁琐步骤，没有占用你吃紧的内存，最重要的是功能一样大而全而且免费不要钱。
 </p>
 <h2>
  SQLite安装
 </h2>
 <p>
  几乎所有版本的 Linux 操作系统都附带 SQLite，所以win党们请自行在官网上下载安装即可。
 </p>
 <pre><code>➜  ~ sqlite3 
SQLite version 3.8.10.2 2015-05-20 18:17:19
Enter ".help" for usage hints.
Connected to a transient in-memory database.
Use ".open FILENAME" to reopen on a persistent database.
sqlite&gt;
</code></pre>
 <p>
  通过终端输入sqlite3即可验证数据库是否安装成功！
 </p>
 <h2>
  python中使用sqlite3
 </h2>
 <p>
  通过Python结合sqlite3实现一个简单的个人备忘录，简单了解一下在Python中是如何操作数据库的。
在Python中操作sqlite很简单，引入sqlite3模块，就可以开始进行数据库的编程之旅了。
 </p>
 <h2>
  创建数据库
 </h2>
 <pre><code>import sqlite3#引入模块
import os
from datetime import *
print(os.path.join(os.path.dirname(__file__), 'memorandum.db'))
conn = sqlite3.connect(os.path.join(os.path.dirname(__file__), 'memorandum.db'))#在当目录下创建数据库
print('备忘录数据库创建成功！')
</code></pre>
 <h2>
  创建表及字段
 </h2>
 <p>
  cursor()将创建一个cursor对象，将在Python数据库编程中用到。
cursor.execute()将处理操作与数据库相关的几乎所有命令。
 </p>
 <pre><code>c = conn.cursor()#创建一个cursor对象
# 创建表
c.execute('''create table tab(
    id integer not null primary key autoincrement,
    title char(50),
    content text not null,
    c_date text);''')
print('数据表创建成功！')
conn.commit()#提交事务
conn.close()#关闭连接
</code></pre>
 <p>
  通过以上代码就可以在数据库中创建一个表了，如果你不太习惯在代码中创建表，你可以使用DBeaver,操作简单方便人性化，是编写数据库命令，查看数据库表结构，备份数据之良品。
有了数据表，我们就可以对表进行增删改查了。
sqlite中的sql语句和大部分数据库操作语名是相同的，如果你有过其它数据库操作的基础，那么使用sqlite就会非常简单了
 </p>
 <h2>
  插入数据
 </h2>
 <pre><code>title = '测试标题'
content = '插入数据测试。'
format = "%Y-%m-%d %H:%M:%S"
now = datetime.now().strftime(format)#创建当前时间字符串
sql = "insert into tab (id,title, content, c_date) values (NULL,'{0}','{1}','{2}')".format(title,content,now)
print(sql)
c.execute(sql)
conn.commit()
conn.close()#关闭连接
</code></pre>
 <h2>
  批量插入数据
 </h2>
 <p>
  python往sqlite3插入数据的sql语句支持'?'占位符，这样我们很方便的可以批量插入数据。
 </p>
 <pre><code># 准备10000条数据插入
for i in range(10000):
    format = "%Y-%m-%d %H:%M:%S"
    now = datetime.now().strftime(format)#创建当前时间字符串
    c.execute('insert into tab (id,title, content, c_date) values(?,?,?,?)',(None,str(i),str(i),now))
conn.commit()#提交事务
conn.close()
</code></pre>
 <h2>
  删除数据
 </h2>
 <pre><code>sql = "delete from tab where id = 2"#拼装sql语句
c.execute(sql)#执行删除
conn.commit()
conn.close()
</code></pre>
 <p>
  执行上边的代码，发现id为2的数据已经被删除。
  <img alt="输入图片说明" src="/assets/images/media/upload/2017/11/Snip20171116_11.png"/>
 </p>
 <h2>
  更新数据
 </h2>
 <pre><code>sql = "update tab set title='Boy' where id = 20004"
c.execute(sql)
conn.commit()
conn.close()
</code></pre>
 <h2>
  查询数据
 </h2>
 <pre><code>sql = "select * from tab"
l = c.execute(sql)
for s in l :
    print(s)
conn.close
</code></pre>
 <p>
  运行代码后可以看到终端输出：
  <img alt="输入图片说明" src="/assets/images/media/upload/2017/11/Snip20171116_12.png"/>
 </p>
 <p>
  其它查询只是sql语句的不同，这里暂时不再测试了，有兴趣的可以查阅sql编程相关资料。
综合来说，
  <code>
   python
  </code>
  与
  <code>
   sqlite3
  </code>
  联合使用真是很方便，是数据采集入库处理查询必备哇。
 </p>
 <h2>
  本文源码下载：
 </h2>
 <ul>
  <li>
   <a href="https://github.com/bosichong/17python.com/tree/master/sqlite3">
    github
   </a>
  </li>
  <li>
   <a href="https://gitee.com/J_Sky/17python.com/tree/master/sqlite3">
    开源中国码云镜像gitee
   </a>
  </li>
 </ul>
 <div class="blog-article">
  <h1 class="title">
   实战：利用Django开发部署自己的个人博客（3）Template: Django模板
  </h1>
  <span class="author">
   J.sky
  </span>
  <span class="time">
   2017-11-10 09:19:19
  </span>
  <span class="tag">
   Django
  </span>
 </div>
 <p>
 </p>
 <p>
  一般WEB框架构建几乎相同，都会有路由，视图，模板，中间件等大多功能相同的组件，
  <code>
   Django
  </code>
  也有自己的
  <code>
   Template: Django模板
  </code>
  。
 </p>
 <h2>
  配置及使用
  <code>
   Django
  </code>
  的模板
 </h2>
 <p>
  依然使用第一节创建的是项目，创建
  <code>
   myblog.templates.home.html
  </code>
  。
 </p>
 <pre><code>&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;Home Page&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    {{ s }}
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
 <p>
  然后编写视图文件
  <code>
   myblog.views.py
  </code>
  代码：
 </p>
 <pre><code>def home(request):
    s = 'Hello World!'
    return render(request,'home.html',{'s':s})
</code></pre>
 <p>
  配置路由
  <code>
   mybolg.urls.py
  </code>
  添加代码：
 </p>
 <pre><code>url(r'^home$', v.home, name='home'),
</code></pre>
 <p>
  到此一组路由、视图、模板就配置完了，启动服务器：
  <code>
   python3 manage.py runserver
  </code>
  打开网址：
  <code>
   http://127.0.0.1:8000/blog/home
  </code>
  你会看到如下图：
 </p>
 <p>
  <img alt="输入图片说明" src="/assets/images/media/upload/2017/11/Snip20171110_7.png"/>
 </p>
 <h2>
  继续深入模板
 </h2>
 <p>
  我们修改视图
  <code>
   myblog.views.py
  </code>
  中的代码如下：
 </p>
 <pre><code>def home(request):
    s = 'Hello World!'
    l = [1,2,3,4,5,6,7,8]
    info_dict = {'h': 'hello', 'w': 'world'}
    return render(request, 'blog/home.html', {'s':s, 'l':l, 'info_dict':info_dict})
</code></pre>
 <p>
  这次我们添加了一个列表，一组字典，看看在模板中是如何渲染这类数据的。
 </p>
 <p>
  继续修改
  <code>
   myblog.templates.home.html
  </code>
  :
 </p>
 <pre><code>&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;Home Page&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    {% comment %} 变量输出 {% endcomment %}
    &lt;h1&gt;{{ s }}&lt;/h1&gt;
    &lt;br/&gt; {% comment %} 循环输出list {% endcomment %} {% for i in l %} {{ i }} {% endfor %}
    &lt;br/&gt; {% comment %} 字典输出 {% endcomment %} {{ info_dict.h }} {{ info_dict.w }}
    &lt;br/&gt; {% comment %} 循环输出字典 {% endcomment %} {% for key, value in info_dict.items %} {{ key }} : {{ value }} 
    {% endfor %}
&lt;h1&gt;&lt;a href="{% url 'blog:home' %}"&gt;测试&lt;/a&gt;&lt;/h1&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
 <p>
  刷新查看一下网页
 </p>
 <p>
  <img alt="输入图片说明" src="/assets/images/media/upload/2017/11/Snip20171110_8.png"/>
 </p>
 <p>
  是不是感觉
  <code>
   Django
  </code>
  模板中的沉浸很方便？我们几行代码就渲染了列表，字典。
 </p>
 <h2>
  一些常用标签
 </h2>
 <pre><code># 变量
## 通过下标获取列表变量的值
{{ names.0 }}

# 注释
{# 单行注释 #}
{% comment %}多行注释{% endcomment %}

# url路由
有这样一个路由
url(r'^blog/', 'myapp.views.blog'), # 博客页面
那么就这样使用
{% url 'digital.views.blog' %}
或者使用别名，例如
url(r'^blog/', 'myapp.views.blog', name='blog'),
{% url 'blog' %}
如果是其他app的url，那么需要带上该app的namespace，首先在定义的时候需要添加namespace，如
url(r'^oauth/', include('oauth.urls', namespace='oauth'))
然后在实用url的时候：
{% url 'oauth:hello' %}

# for循环
{% for &lt;element&gt; in &lt;list&gt; %}{% endfor %}
{% for &lt;element&gt; in &lt;list&gt; reversed%}{% endfor %} 反向迭代列表
{% for &lt;element&gt; in &lt;list&gt; %}{% empty %}{% endfor %} 列表为空时的输出内容
{{ forloop.counter }}   # 获取当前索引，默认从1开始
{{ forloop.counter0 }}  # 获取当前索引，从0开始

# if语句
{% if &lt;element&gt; %}
{% elif &lt;element&gt; %} 
{% else %}
{% endif %}

{% ifequal 变量1 变量2 %}
比较值
{% endifequal %}
ifnotequal同上
# autoescape标签

{% autoescape on %}       # 去掉自动转义
{{ body }}
{% endautoescape %}

# cycle标签：每次使用该标签，标签中的值就会变化，比如下面这个，第一次该值为row1，第二次则为row2，第三次又变为了1，感觉可以用于循环里面的奇偶什么的
{% for o in some_list %}
&lt;tr class="{% cycle 'row1' 'row'2 %}
...
&lt;/tr&gt;
{% endfor %}

# now 标签，直接将当前时间按指定格式输出：
{% now "jS F Y H:i" %}

# spaceless标签：移出HTML tags之间的空白
{% spaceless %}
&lt;p&gt;
...
&lt;/p&gt;
{% endspaceless %}

# verbatim：停止模版引擎，一般用于在模板里面写Javascript什么的
{% verbatim %}
...
{% endverbatim %}

# with标签：和语法里面的with类似
{% with total=business.employees.count %}
{{ total }} employee{{ total|pluralize }}
{% endwith %}
</code></pre>
 <p>
  关于模板强大的功能还有很多，建议参考官方文档进行查阅。
 </p>
 <p>
  本文部分代码引自
  <a href="http://www.jianshu.com/p/bc6d8f03eacf?utm_source=desktop&amp;utm_medium=timeline">
   我的Django手册
  </a>
 </p>
 <h2>
  本文源码下载：
 </h2>
 <ul>
  <li>
   <a href="https://github.com/bosichong/17python.com/tree/master/Django">
    github
   </a>
  </li>
  <li>
   <a href="https://gitee.com/J_Sky/17python.com/tree/master/Django">
    开源中国码云镜像gitee
   </a>
  </li>
 </ul>
 <div class="blog-article">
  <h1 class="title">
   实战：利用Django开发部署自己的个人博客（2）视图/路由
  </h1>
  <span class="author">
   J.sky
  </span>
  <span class="time">
   2017-11-09 09:53:45
  </span>
  <span class="tag">
   Django
  </span>
 </div>
 <p>
 </p>
 <p>
  <code>
   Django
  </code>
  的强大之处上节我们已经体验过了，虽然上线部署还有一段距离，但一个好的开始就是预示成功即将到来。。。
 </p>
 <h2>
  <code>
   Django
  </code>
  的配置文件
 </h2>
 <p>
  <code>
   blog01.settings.py
  </code>
  是你的项目配置文件，这里可以配置的网站常用的选项。
 </p>
 <ul>
  <li>
   <code>
    BASE_DIR
   </code>
   表示当前网站的根目录，当然你也可以添加并设置其它目录的常量
  </li>
  <li>
   <code>
    DEBUG=True
   </code>
   的时候是开发模式，当上线部署在生产模式时这里应该设置为False
  </li>
  <li>
   <code>
    INSTALLED_APPS
   </code>
   这里设置你建好并启用的app 比如添加我们创建的
   <code>
    'myblog',
   </code>
   ，直接添加到后边即可，记得那个逗号。
  </li>
  <li>
   <code>
    MIDDLEWARE Django
   </code>
   中需要的模块，如果需要Django新功能模块，需要在这里添加。
  </li>
  <li>
   <code>
    ROOT_URLCONF = 'blog01.urls'
   </code>
   这个表示一个默认的路由，可以在这里设置一些路由的跳转
  </li>
  <li>
   <code>
    DATABASES
   </code>
   设置数据库，这里我们使用默认的数据库
   <code>
    sqlite3
   </code>
   即可。
  </li>
 </ul>
 <p>
  还有一些其它设置项，我们会在后边用到的时候介绍，另外你也可以参考官方网站的相关文档。
 </p>
 <p>
  我们先设置一下项目配置文件，启用新项目myblog:
  <code>
   INSTALLED_APPS
  </code>
  这里设置你建好并启用的app 比如添加我们创建的
  <code>
   'myblog',
  </code>
  ，直接添加到后边即可，记得那个逗号。
 </p>
 <p>
  <img alt="配图" src="![输入图片说明](/assets/images/media/upload/2017/11/Snip20171109_4.png"/>
 </p>
 <p>
  接下来我们就可以设置路由
 </p>
 <h2>
  配置路由
 </h2>
 <p>
  路由是什么东东？假设你有一个网站域名
  <code>
   17python.com
  </code>
  ,在主域名下的/blog或/news是单独一个app，
这时你就可以使用路由，单独指向自己的空间方便区分。设置我们的blog路由：
在
  <code>
   blog01/urls.py
  </code>
  中设置如下代码：
 </p>
 <pre><code>from django.conf.urls import url, include
from django.contrib import admin
urlpatterns = [
    url(r'^admin/', admin.site.urls),
    url(r'^blog/', include('myblog.urls',namespace='blog')),
]
</code></pre>
 <p>
  这样设置路由就是把blog/下边的路由都交给
  <code>
   myblog.usrs.py
  </code>
  中来设置了。我们继续设置一个视图，验证一下我们的路由是否成功
 </p>
 <h2>
  编写视图
 </h2>
 <p>
  视图与路由是对好兄弟，一般都是相互存在的。我们来设置一下
  <code>
   blog
  </code>
  的主页。
先编写
  <code>
   myblog.views.py
  </code>
  中视图代码：
 </p>
 <pre><code>from django.http import HttpResponse, HttpResponseRedirect
def index(request):
    return HttpResponse('你好，Django,江哥？')
</code></pre>
 <p>
  设置
  <code>
   myblog.urls.py
  </code>
  中的路:
 </p>
 <pre><code>urlpatterns = [
    url(r'^$', v.index),#项目首页
    ]
</code></pre>
 <p>
  设置到这里，我们就可以启动服务器测试了,还记得服务器启动命令不？
 </p>
 <pre><code>python3 manage.py runserver
</code></pre>
 <p>
  <img alt="输入图片说明" src="/assets/images/media/upload/2017/11/Snip20171109_6.png"/>
 </p>
 <p>
  如果显示和上图一样的话，那么恭喜你！配置成功！
 </p>
 <h2>
  本文源码下载：
 </h2>
 <ul>
  <li>
   <a href="https://github.com/bosichong/17python.com/tree/master/Django">
    github
   </a>
  </li>
  <li>
   <a href="https://gitee.com/J_Sky/17python.com/tree/master/Django">
    开源中国码云镜像gitee
   </a>
  </li>
 </ul>
 <div class="blog-article">
  <h1 class="title">
   实战：利用Django开发部署自己的个人博客（1）创建项目
  </h1>
  <span class="author">
   J.sky
  </span>
  <span class="time">
   2017-11-08 11:27:29
  </span>
  <span class="tag">
   Django
  </span>
 </div>
 <p>
 </p>
 <h2>
  写在开篇
 </h2>
 <p>
  很早就想写一个有关
  <code>
   Django
  </code>
  相关的系列博文，因为通过
  <code>
   Django
  </code>
  开发本博客的过程中有很多感触，深深的体会到
  <code>
   Python Django
  </code>
  的强大与灵活，
所以，是时候写下这些从开发到上线部署过程中遇到的坑与灵光闪现的点滴。
 </p>
 <h2>
  为什么要自己开发部署一个线上博客？
 </h2>
 <p>
  从需求的角度上来说，自己开发一个博客纯属重复造轮子，因为现成的功能丰富的博客系统网上有很多了，比如一些程序员喜欢的博客网站：
 </p>
 <ul>
  <li>
   csdn
  </li>
  <li>
   oschina
  </li>
  <li>
   简书
  </li>
  <li>
   新浪博客
  </li>
 </ul>
 <p>
  。。。。。。
 </p>
 <p>
  很多很多，还有一些现在的框架程序比如php下大名鼎鼎的
  <code>
   WordPress
  </code>
  等，都可以快速的搭建一个功能丰富的博客。
那么为什么我们还要自己利用
  <code>
   python django
  </code>
  搭建一个线上博客呢？
答案很简单，我们需要实践，需要更多的敲打代码的机会，更多程序构建思考的机会。
 </p>
 <h2>
  需要的知识点。
 </h2>
 <p>
  首先这并不是一篇给无
  <code>
   python
  </code>
  基础人看的博文，你必须已经拥有
  <code>
   python
  </code>
  相关的基础知识，并且你需要了解
  <code>
   html css js
  </code>
  及有一些相关框架的知识。
另外，还需要对数据库有一定了解，至少需要明白一些常用的增删改查操作。
因为这是一个需要上线部署的博客，你还需要有一些服务器维护的经验，当然这个后期我会介绍一些的。
美工？需要一个美工吗？如果一个博客打开后没有一点个性的话，估计是没什么人愿意看的。
当然，最重要的还是需要有一颗耐心细心爱学的心，一种编程的态度。
 </p>
 <h2>
  博客搭建环境
 </h2>
 <p>
  这个是开发阶段的运行环境，部署时我会说明部署环境的。
 </p>
 <pre><code>OS X 10.11.6 
Python 3.6.1
VSCode 1.15.1
Django 尽量用最新版。
</code></pre>
 <p>
  关于程序环境我想说，不建议新手使用什么多个虚拟环境，你只在这一个环境下操作即可，重点放在博客的开发测试过程中来。
有关
  <code>
   python VSCode
  </code>
  安装配置，网上有很多教程，这里不在重复介绍了，
  <code>
   Django
  </code>
  在win与osx下边的运行基本上差不多，
所以你使用win10或xp也适用本教程，只是安装配置你需要按着自己的环境来操作，Djaogn中的代码是一至的。
 </p>
 <h2>
  Django 安装
 </h2>
 <pre><code>pip3 install Django
</code></pre>
 <p>
  如果你需要指定版本
 </p>
 <pre><code>pip3 install Django == 1.1X
</code></pre>
 <p>
  如果无法在线安装，请下载安装
  <a href="https://www.djangoproject.com/download/">
   https://www.djangoproject.com/download/
  </a>
  下载后，解压并进入目录：
 </p>
 <pre><code>python setup.py install
</code></pre>
 <p>
  查看是否安装成功？
 </p>
 <pre><code>
➜  ~ python3                                                    
Python 3.6.1 (v3.6.1:69c0db5050, Mar 21 2017, 01:21:04) 
[GCC 4.2.1 (Apple Inc. build 5666) (dot 3)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
&gt;&gt;&gt; import django
&gt;&gt;&gt; print(django.VERSION)
(1, 11, 3, 'final', 0)

</code></pre>
 <p>
  如果报错则是安装失败，成功显示和上边略同。
 </p>
 <h2>
  第一个Django项目
 </h2>
 <p>
  我们来创建第一个项目，进入你要创建项目的目录，终端下输入：
 </p>
 <pre><code>django-admin startproject blog01
</code></pre>
 <p>
  然后进入目录：
    python3 manage.py startapp myblog
 </p>
 <p>
  运行项目：
 </p>
 <pre><code>python3 manage.py runserver
Performing system checks...

System check identified no issues (0 silenced).

You have 13 unapplied migration(s). Your project may not work properly until you apply the migrations for app(s): admin, auth, contenttypes, sessions.
Run 'python manage.py migrate' to apply them.

November 08, 2017 - 03:22:17
Django version 1.11.3, using settings 'blog01.settings'
Starting development server at http://127.0.0.1:8000/
Quit the server with CONTROL-C.
</code></pre>
 <p>
  好啦，大功告成！
 </p>
 <p>
  <img alt="输入图片说明" src="/assets/images/media/upload/2017/11/Snip20171108_1.png"/>
 </p>
 <h2>
  本文源码下载：
 </h2>
 <ul>
  <li>
   <a href="https://github.com/bosichong/17python.com/tree/master/Django">
    github
   </a>
  </li>
  <li>
   <a href="https://gitee.com/J_Sky/17python.com/tree/master/Django">
    开源中国码云镜像gitee
   </a>
  </li>
 </ul>
 <div class="blog-article">
  <h1 class="title">
   如何快速的复习学习过的Python
  </h1>
  <span class="author">
   J.sky
  </span>
  <span class="time">
   2017-11-07 16:19:22
  </span>
  <span class="tag">
   Python基础
  </span>
 </div>
 <p>
 </p>
 <p>
  最近老妈骨折住院，在医院护理了有8天，终于回出院回家了。回到家第一件事就是想到之前学习了python，如何快速的复习一下曾经学过的
  <code>
   python
  </code>
  呢？
 </p>
 <h2>
  语法/变量/表达式
 </h2>
 <p>
  也许我们能找到一个小小例子来快速的复习一下基本语法，那么这种例子有很多，比如：打印九九乘法表/斐波那契数列/排序法等等。
 </p>
 <h2>
  九九乘法表
 </h2>
 <p>
  快速复习
  <code>
   for
  </code>
  及
  <code>
   print format
  </code>
  等函数的用法。
 </p>
 <pre><code>for i in range(1,10):
    for j in range(1,i+1):
        print("{}X{}={}".format(i,j,i*j), end=' ')
    print()
</code></pre>
 <h2>
  一摞
  <code>
   Python
  </code>
  风格的纸牌
 </h2>
 <p>
  在看《流畅Python》那本书的时候，第一章第一个小例子非常吸引人，具体代码如下
Python3 扑克牌
  <code>
   collections.namedtuple
  </code>
  这个函数可以快速创建一个只有属性的类，我们通过这个方法来创建一张扑克牌的类，rank 和 suit 分别代表牌面数值和花色
 </p>
 <pre><code>import collections
from random import choice
Card = collections.namedtuple('Card',['rank','suit'])
#创建一副扑克牌的类
class Cards:
    ranks = [str(n) for n in range(2,11)] + list('JQKA')#从2-10的数字
    suits = 'spades clubs diamonds clubs'.split()# 黑桃 方块 草花 红桃

    def __init__(self):
        '''创建一副扑克牌'''
        self._cards = [Card(rank,suit) for suit in self.suits
                                       for rank in self.ranks] + ['King','Queen']
    def __len__(self):
        return len(self._cards)
    def __getitem__(self,position):
        return self._cards[position]

deck = Cards()#创建一副扑克牌
print(len(deck))#打印有多少张
#打印所有纸牌
for i in range(len(deck)):
    print(deck[i])
print(choice(deck))#随机抽取一张纸牌
</code></pre>
 <p>
  我觉得这个纸牌的小例子很有意思，复习了类及列表推导等一些小概念。当然快速复习的小例子还有很多的，比如下边的例子
 </p>
 <h2>
  简单的复利计算
 </h2>
 <pre><code>p = 10000 #初始金额
rate = 0.04/365 #利率 例如余额宝的年化收益为4%，那么每天的这里计算每天的收益
days = 100

day = 1
while day &lt;= days :
    p = p * (1+rate)#复利，余额宝是每天的利滚利
    print('%s天：%2.2f' % (day,p)) #打印当前年份及金额
    day += 1
</code></pre>
 <p>
  通过以上三个小例子，是不是又引起了你对Python的兴趣？温故而知新，大家加油哦！
 </p>
 <h2>
  本文源码下载：
 </h2>
 <ul>
  <li>
   <a href="https://github.com/bosichong/17python.com/blob/master/ReviewPython.py">
    github
   </a>
  </li>
  <li>
   <a href="https://gitee.com/J_Sky/17python.com/blob/master/ReviewPython.py">
    开源中国码云镜像gitee
   </a>
  </li>
 </ul>
 <div class="blog-article">
  <h1 class="title">
   python中导入不同目录中的自定义模块/class/函数/方法
  </h1>
  <span class="author">
   J.sky
  </span>
  <span class="time">
   2017-10-27 10:37:17
  </span>
  <span class="tag">
   Python基础
  </span>
 </div>
 <p>
 </p>
 <p>
  前几天在封装
  <code>
   PY_RPG
  </code>
  框架时，需要导入一些自定义的类、函数、常量的时候，发现始终找不到相关模块，后来参考书籍及网络上的一些经验终于解决了这个问题。
 </p>
 <h2>
  包和模块导入的需求
 </h2>
 <p>
  假设有一个项目，有a/a.py（此为工具类提供一些简单的方法和常量），b/b.py（需要调用a/a.py）项目文件，我们先在a.py中定义一些函数及常量一会引入使用。
 </p>
 <pre><code>M_TEST = 888
def print_text():
    print('这a.py下的一个打印文字函数')
</code></pre>
 <p>
  现在我们引入测试
 </p>
 <pre><code>import a.a
a.print_text()
</code></pre>
 <p>
  ModuleNotFoundError: No module named 'a'  很显然这样是找不到正确目录的，那么问题来了，
如果是在同一目录，我们直接
  <code>
   import a
  </code>
  就搞定了，但实际工作中我们不可能把所有文件都放在一个目录中，如果需要导入其它目录的中.py文件，这时我们就需要用到
  <code>
   sys.path.append()
  </code>
 </p>
 <pre><code>['/Users/mac/PycharmProjects/PythonStudy/b', '/Library/Frameworks/Python.framework/Versions/3.6/lib/python36.zip', '/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6', '/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/lib-dynload', '/Users/mac/Library/Python/3.6/lib/python/site-packages', '/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages', '/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/beautifulsoup4-4.6.0-py3.6.egg', '/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/PyMySQL-0.7.11-py3.6.egg', '/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/xadmin-0.6.1-py3.6.egg', '/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/django_formtools-2.0-py3.6.egg']
</code></pre>
 <p>
  打印后，我们会发现很多目录，
  <code>
   python
  </code>
  加载包模块的目录就都在上边了，他会从这些目录中搜索需要加载内容的名称，如果有就加载进来。
那么我们如何把自己的文件加到上边的目录里？有几种方法：
 </p>
 <ul>
  <li>
   通过修改环境变量，这个不环保，而且文件多了，不可能都去修改。
  </li>
  <li>
   复制文件到上边的目录中，有些不方便，不推荐
  </li>
  <li>
   <code>
    sys.path.append()
   </code>
   把目录加进索引，方便python搜索，推荐
  </li>
 </ul>
 <p>
  那么我们来试试吧
 </p>
 <h2>
  如何优雅的获得目录地址？
 </h2>
 <p>
  如果需要把目录加进到索引中，我们只需要一个绝对地址即可，但是这种方法如果我们复制工程到其它目录后，我们还需要修改这个索引，很不方便不科学。
这时我想到了
  <code>
   Django
  </code>
  配置文件中有一段代码
 </p>
 <pre><code>BASE_DIR = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))
</code></pre>
 <p>
  我们理解一下这段代码，
  <code>
   __file__
  </code>
  表示当前.py文件，
  <code>
   os.path.abspath(__file__)
  </code>
  表示当前.py文件的绝对地址，
  <code>
   dirname
  </code>
  获得上一层目录地址，
那么如果我们当前的文件在根目录下的一个目录下边，那么上条语句正好获得了根目录的地址。我们来打印试试
 </p>
 <pre><code>/Users/mac/PycharmProjects/PythonStudy/b/b.py
/Users/mac/PycharmProjects/PythonStudy/b
/Users/mac/PycharmProjects/PythonStudy
</code></pre>
 <p>
  可以看到根目录地址已经得到了，然后通过
  <code>
   os.path.join()
  </code>
  就可以拼装到工具类目录地址了，到这里我们的所有功能基本上可以实现了，具体实现请看下边的代码。
 </p>
 <pre><code>import os 
BASE_DIR = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))#获取根目录
print(os.path.abspath(__file__))
print(os.path.dirname(os.path.abspath(__file__)))
print(BASE_DIR)
T_DIR = os.path.join(BASE_DIR,'a')#拼装工具类地址
print(T_DIR)
sys.path.append(T_DIR)
import a
print(a.M_TEST)
a.print_text()
</code></pre>
 <h2>
  本文源码下载： a b 两个目录下为相关源文件
 </h2>
 <ul>
  <li>
   <a href="https://github.com/bosichong/17python.com/">
    github
   </a>
  </li>
  <li>
   <a href="https://gitee.com/J_Sky/17python.com/">
    开源中国码云镜像gitee
   </a>
  </li>
 </ul>
 <div class="spage">
  <div aria-label="Basic example" class="pagination pagination4 btn-group" id="suiyanpage" role="group">
   <a href="/list/list_8.html">
    <button class="prev btn btn-primary" type="button">
     Previous
    </button>
   </a>
   <button class="page btn btn-primary" type="button">
    9 / 17
   </button>
   <a href="/list/list_10.html">
    <button class="next btn btn-primary" type="button">
     Next
    </button>
   </a>
  </div>
 </div>
</div>
   </section>
   <script src="/assets/plugins/jquery-3.3.1.min.js">
   </script>
   <!-- Javascript -->
   <script src="/assets/plugins/bootstrap/js/bootstrap.min.js">
   </script>
   <footer class="footer text-center py-2 theme-bg-dark">
    <div class="card text-center">
     <div class="card-body">
      <p>
       <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="license" target="_blank">
        <img src="https://licensebuttons.net/l/by-nc-sa/4.0/80x15.png" style="border-width:0"/>
       </a>
      </p>
      <p class="am-text-sm am-text-center">
       <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="license" target="_blank">
        本站采用知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议进行许可。
       </a>
      </p>
      <p>
       Powered by
       <a href="https://gitee.com/J_Sky/suiyan">
        SuiYan
       </a>
       | by J.sky
       <small>
        Copyright
        <i aria-hidden="true" class="fa fa-copyright">
        </i>
        2017-2020 碎言博客
       </small>
      </p>
     </div>
    </div>
    <!-- Scroll to Top button selector -->
    <a class="to-top">
     <i aria-hidden="true" class="fa fa-chevron-up fa-3">
     </i>
    </a>
    <script src="/assets/plugins/jquery.toTop.min.js">
    </script>
    <script>
     jQuery(function($){
            // Plugin activation (basic - with all default values)
            // $('.to-top').toTop();

            // Plugin activation with options
            $('.to-top').toTop({
                //options with default values
                autohide: true,  //boolean 'true' or 'false'
                offset: 420,     //numeric value (as pixels) for scrolling length from top to hide automatically
                speed: 500,      //numeric value (as mili-seconds) for duration
                position:true,   //boolean 'true' or 'false'. Set this 'false' if you want to add custom position with your own css
                right: 15,       //numeric value (as pixels) for position from right. It will work only if the 'position' is set 'true'
                bottom: 30       //numeric value (as pixels) for position from bottom. It will work only if the 'position' is set 'true'
            });
        });
    </script>
    <!-- 搜索模态对话框。 -->
    <div aria-hidden="true" aria-labelledby="myLargeModalLabel" class="modal fade bd-example-modal-lg" role="dialog" tabindex="-1">
     <div class="modal-dialog modal-lg">
      <div class="modal-content">
       <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLongTitle">
         搜索结果
        </h5>
        <button aria-label="Close" class="close" data-dismiss="modal" type="button">
         <span aria-hidden="true">
          ×
         </span>
        </button>
       </div>
       <div class="modal-body">
        <ul class="search-list car-list navbar-nav">
        </ul>
       </div>
      </div>
     </div>
    </div>
    <!-- 站点自定义JS -->
    <script src="/assets/js/build/index.js">
    </script>
    <!-- highlight.js Markdown代码美化 -->
    <script src="/assets/plugins/highlight/highlight.pack.js">
    </script>
    <script>
     hljs.initHighlightingOnLoad();
    </script>
   </footer>
  </div>
  <!--//main-wrapper-->
 </body>
</html>